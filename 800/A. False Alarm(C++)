#include <bits/stdc++.h>
using namespace std;

int main(){

	ios::sync_with_stdio(false);
	cin.tie(nullptr);


	int t;
	cin >> t;

	while(t--){

		int n;
		int x;

		cin >> n >> x;

		int onec=0;
		int f1=-1;

		vector<int>arr(n);

		for(int i=0;i<n;i++){
			cin >> arr[i];
			if(arr[i]==1){
				onec++;
				if(f1==-1){
					f1=i;
				}
			}
		}

		for(int i=f1;i<n;i++){
				x--;
				if(arr[i]==1){
					onec--;
				}
				if(x==0){

				    if(onec>0){
					cout << "NO" << "\n";
				    }
				    else{
					cout << "YES" << "\n";
					}
					break;
				}
		}
		if(x>0){
			cout << "YES" << "\n";
		}

	}
}

